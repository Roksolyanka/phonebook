{"ast":null,"code":"import { createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nexport const $instance = axios.create({\n  baseURL: process.env.REACT_APP_API_URL\n});\n$instance.interceptors.response.use(response => response, error => {\n  console.error('API error:', error.response || error.message);\n  return Promise.reject(error);\n});\nexport const setToken = token => {\n  $instance.defaults.headers['Authorization'] = `Bearer ${token}`;\n};\nexport const clearToken = () => {\n  $instance.defaults.headers['Authorization'] = '';\n};\nexport const registerUserThunk = createAsyncThunk('auth/register', async (userData, thunkApi) => {\n  try {\n    const {\n      data\n    } = await $instance.post('/users/signup', userData);\n    setToken(data.token);\n    return data;\n  } catch (error) {\n    console.error('Registration error:', error.response || error.message);\n    return thunkApi.rejectWithValue(error.message);\n  }\n});\nexport const loginUserThunk = createAsyncThunk('auth/login', async (userData, thunkApi) => {\n  try {\n    const {\n      data\n    } = await $instance.post('/users/login', userData);\n    setToken(data.token);\n    return data;\n  } catch (error) {\n    return thunkApi.rejectWithValue(error.message);\n  }\n});\nexport const refreshUserThunk = createAsyncThunk('auth/refreshUser', async (_, thunkApi) => {\n  const state = thunkApi.getState();\n  const token = state.auth.token;\n  try {\n    setToken(token);\n    const {\n      data\n    } = await $instance.get('/users/current');\n    return data;\n  } catch (error) {\n    return thunkApi.rejectWithValue(error.message);\n  }\n});\nexport const logoutUserThunk = createAsyncThunk('auth/logout', async (_, thunkApi) => {\n  try {\n    const {\n      data\n    } = await $instance.post('/users/logout');\n    clearToken();\n    return data;\n  } catch (error) {\n    return thunkApi.rejectWithValue(error.message);\n  }\n});","map":{"version":3,"names":["createAsyncThunk","axios","$instance","create","baseURL","process","env","REACT_APP_API_URL","interceptors","response","use","error","console","message","Promise","reject","setToken","token","defaults","headers","clearToken","registerUserThunk","userData","thunkApi","data","post","rejectWithValue","loginUserThunk","refreshUserThunk","_","state","getState","auth","get","logoutUserThunk"],"sources":["D:/Роксолана/IT/Goit/phonebook/src/redux/auth/operations.js"],"sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\nexport const $instance = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL,\r\n});\r\n\r\n$instance.interceptors.response.use(\r\n  response => response,\r\n  error => {\r\n    console.error('API error:', error.response || error.message);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport const setToken = token => {\r\n  $instance.defaults.headers['Authorization'] = `Bearer ${token}`;\r\n};\r\n\r\nexport const clearToken = () => {\r\n  $instance.defaults.headers['Authorization'] = '';\r\n};\r\n\r\nexport const registerUserThunk = createAsyncThunk(\r\n  'auth/register',\r\n  async (userData, thunkApi) => {\r\n    try {\r\n      const { data } = await $instance.post('/users/signup', userData);\r\n      setToken(data.token);\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Registration error:', error.response || error.message);\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const loginUserThunk = createAsyncThunk(\r\n  'auth/login',\r\n  async (userData, thunkApi) => {\r\n    try {\r\n      const { data } = await $instance.post('/users/login', userData);\r\n      setToken(data.token);\r\n\r\n      return data;\r\n    } catch (error) {\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const refreshUserThunk = createAsyncThunk(\r\n  'auth/refreshUser',\r\n  async (_, thunkApi) => {\r\n    const state = thunkApi.getState();\r\n    const token = state.auth.token;\r\n    try {\r\n      setToken(token);\r\n      const { data } = await $instance.get('/users/current');\r\n\r\n      return data;\r\n    } catch (error) {\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const logoutUserThunk = createAsyncThunk(\r\n  'auth/logout',\r\n  async (_, thunkApi) => {\r\n    try {\r\n      const { data } = await $instance.post('/users/logout');\r\n      clearToken();\r\n\r\n      return data;\r\n    } catch (error) {\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}